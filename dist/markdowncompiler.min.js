(()=>{"use strict";var e=/^```[\s\S]*$/,n=/^```$/,t=/^#{1,6} .*$/,r=/[&<>"]/,a=/[&<>"]/g;function i(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.rules=[s,u,c]}var n,t;return n=e,(t=[{key:"getRules",value:function(){return this.rules}}])&&i(n.prototype,t),e}();function s(t,r,a){var i=t.getLinesContent(r);if(!e.test(i))return!1;var o=r+1,s=i.split("```")[1];for(t.beginMarks[o],t.endMarks[o],o=r+1;o<a&&!n.test(t.getLinesContent(o));o++);return content=t.getLinesContent(r+1,o-1),token=t.push("fence","code",0),token.content=content,token.info=s,o+1}function u(e,n,r){var a=e.getLinesContent(n);if(!t.test(a))return!1;var i="h"+a.split(" ")[0].length;return e.push("heading_open",i,1),e.push("inline","text",0).content=a.split(" ")[1],e.push("heading_close",i,-1),n+1}function c(e,n,t){return token=e.push("paragraph_open","p",1),token=e.push("inline","text",0),token.content=e.getLinesContent(n),token=e.push("paragraph_close","p",-1),n+1}function l(e){switch(e){case 9:case 32:return!0}return!1}var h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function f(e){return h[e]}var p=function e(n,t,r){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=n,this.tag=t,this.nesting=r};function g(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var v=function(){function e(n){var t=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),k(this,"push",(function(e,n,r){var a=new p(e,n,r);return r<0&&t.level--,a.level=t.level,r>0&&t.level++,t.tokens.push(a),a})),k(this,"addTokenByProxy",(function(e,n,t,r){})),k(this,"deleteTokenByProxy",(function(e){})),k(this,"changeTokenByProxy",(function(e,n){})),this.src=n,this.beginMarks=[],this.endMarks=[],this.offset=[],this.lineMax=0,this.tokens=[],this.level=0,this.tokensProxy=null,this.initState()}var n,t;return n=e,(t=[{key:"initState",value:function(){var e,n,t,r,a=this.src.length,i=!1,o=this.src;for(e=n=t=0;n<=a;n++){if(r=o.charCodeAt(n),!i){if(l(r)){r==CHAR_SPACE?t++:r===CHAR_TAB&&(t+=4-t%4);continue}i=!0}10!==r&&n!==a-1||(10!==r&&n++,this.beginMarks.push(e),this.endMarks.push(n),this.offset.push(t),i=!1,t=0,e=n+1)}this.lineMax=this.beginMarks.length}},{key:"getLinesContent",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,t=this.beginMarks[e],r=this.endMarks[n],a=this.src.substr(t,r-t);return a}}])&&g(n.prototype,t),e}();function y(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t;return n=e,(t=[{key:"markdown2Tokens",value:function(e){for(var n=new v(e),t=(new o).getRules(),r=0;r<n.lineMax;)for(var a=0;a<t.length;a++){var i=t[a](n,r,n.lineMax);if(i){r=i;break}}return n.tokensProxy=new Proxy(n.tokens,{set:function(e,n,t){return console.log(111),Reflect.set(e,n,t)}}),n.tokens}}])&&y(n.prototype,t),e}();function d(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var _=function(){function e(){var n=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,"defaultRules",{fence:this.fence,heading_open:this.heading_open,heading_close:this.heading_close,paragraph_open:this.paragraph_open,paragraph_close:this.paragraph_close,inline:this.inline}),w(this,"rules",this.defaultRules),w(this,"tokens2Html",(function(e){var t="";return e.forEach((function(e){switch(e.type){case"fence":t+=n.rules.fence(e);break;case"heading_open":t+=n.rules.heading_open(e);break;case"heading_close":t+=n.rules.heading_close(e);break;case"paragraph_open":t+=n.rules.paragraph_open(e);break;case"paragraph_close":t+=n.rules.paragraph_close(e);break;case"inline":t+=n.rules.inline(e)}})),t}))}var n,t;return n=e,(t=[{key:"fence",value:function(e){return"<pre><code>"+(n=e.content,(r.test(n)?n.replace(a,f):n)+"</code></pre>\n");var n}},{key:"heading_open",value:function(e){return"<"+e.tag+">"}},{key:"heading_close",value:function(e){return"</"+e.tag+">"}},{key:"paragraph_open",value:function(e){return"<p>"}},{key:"paragraph_close",value:function(e){return"</p>"}},{key:"inline",value:function(e){return e.content}}])&&d(n.prototype,t),e}();function m(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.parserInstance=new b,this.renderInstance=new _,this.markdown2Tokens=this.parserInstance.markdown2Tokens,this.tokens2Html=this.renderInstance.tokens2Html,this.parser=this.parserInstance.markdown2Tokens}var n,t;return n=e,(t=[{key:"render",value:function(e){return"string"==typeof e?this.tokens2Html(this.markdown2Tokens(e)):e instanceof Array&&this.tokens2Html(e)}}])&&m(n.prototype,t),e}();window.MarkdownCompiler=C})();